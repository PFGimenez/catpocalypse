pico-8 cartridge // http://www.pico-8.com
version 18
__lua__
-- catpocalypse
-- by cpiod

function _init()
	c={}
	g={1,2,0,3}
	g[8]=4
	t={"‚¨ÖÔ∏è quantum box ",
	"‚û°Ô∏è portal?! ",
	"‚¨ÜÔ∏è \"lost\" poster ",
	"‚¨áÔ∏è mega-üÖæÔ∏è "}
	m=1
	d=1
	n=0
	p={100,1000,10,50}
	q={2,4,1,0}
	r={0,0,0,1}
	s=3
end

function _update()
	n+=d/30
	b=a
	u=g[btn()]
	if (u) s=u
	a=btn(üÖæÔ∏è)
	if (a and a!=b) n+=m
	if btn(‚ùé) and #c>=p[s] then
	 for i=#c-p[s]+1,#c do
	  kill_cat(c[i])
  end
		--n-=p[s]
		sfx(0)
		d+=q[s]
		m+=flr(r[s])
		p[s]=flr(p[s]*1.6)
		r[s]*=1.2
	end
	
	n_remove=n/3  	 
	
	while n_remove<0 do
		del(c,c[#c])
		n+=1
		n_remove+=1
	end
	
	while n>1 do
		add(c,make_cat())
		n-=1
	end
end

function make_cat()
	 local p={}
	 colors={6,7,9}
	 local clr=colors[ceil(rnd(#colors))]
	 -- convert sprite 1 to pixels
	 for x=8,15 do
	  for y=0,7 do
	   if(sget(x,y) > 0) add(p,{x=x-8,y=y,c=clr})
	  end
	 end
	 local new_cat=
	   {x=rnd(122),
	    y=7+rnd(110),
	    pixels=p,
	    sparks={},
	    a=1}
	 -- initial sparks
	 for i=1,10 do
		 local spd=1+rnd(2)
		 local a=rnd(1)
		 local p={x=new_cat.x+2,y=new_cat.y+2,vx=spd*cos(a),vy=spd*sin(a),c=new_cat.c,t=10+rnd(10)}
		 add(new_cat.sparks, p)
		end
		return new_cat
end

function kill_cat(e)
 e.a=2
 local t=time()+rnd(1)
 for pixel in all(e.pixels) do
  pixel.t1=t+(pixel.y-pixel.x+7)/15
  pixel.t2=pixel.t1+1
  pixel.t3=pixel.t2+1
  pixel.vx=(1+rnd(1))/2
  pixel.vy=(rnd(3)-2)/2
 end
end
-->8
--draw

function anim(e)
 if e.a==1 then -- spark
	 for p in all(e.sparks) do
	  pset(p.x,p.y,1)
	  p.x+=p.vx
	  p.y+=p.vy
	  p.vx*=0.8
	  p.vy*=0.8
	  p.t-=1
	  if(p.t <= 0) del(e.sparks,p)
	  if(#e.sparks==0) e.a=0 e.sparks=nil
 	end
 elseif e.a==2 then
  for pixel in all(e.pixels) do
   if time() > pixel.t3 then
    del(e.pixels,pixel)
   elseif time() > pixel.t2 then
    pixel.x+=pixel.vx
    pixel.y+=pixel.vy
   elseif time() > pixel.t1 then
    pixel.c=5
   end
  end
  if(#e.pixels==0) del(c,e)
 end
--	?"üê±",e.x,e.y,e.c
 for pixel in all(e.pixels) do
  
  pset(e.x+pixel.x,e.y+pixel.y,pixel.c)
 end
end

function _draw()
 cls()
 foreach(c, anim)
	?#c.."üê±",5,1,3
	?"üÖæÔ∏è="..m.."üê±",45,1,3
	?d.."üê±/s",90,1,3
	?t[s]..p[s].."üê±",20,122,3
end
__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000700000700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700777777700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000707770700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000707770700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700077777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__label__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000330033303330300000300000000000000000000003333300000030303000003000000000000000000000033303330300000300030033000000000000000
00000030030303030333333300000000000000000000033000330333030303333333000000000000000000000000303030333333300300300000000000000000
00000030030303030303330300000000000000000000033030330000033303033303000000000000000000000003303330303330300300333000000000000000
00000030030303030303330300000000000000000000033000330333000303033303000000000000000000000000300030303330300300003000000000000000
00000333033303330033333000000000000000000000003333300000000300333330000000000000000000000033300030033333003000330000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000f00000f000000000000000000000e00000e0d00000d000000000000000000000000a00000800000800000000000000000000000000000
0000000000000000000fffffff000000000000000000000eeeeeee0ddddddd000000000000000000000000aaaaaa88888880000000000000000000000b00000b
0000000000000000000f0fff0f000000000000000000000e0eee0e0d0ddd0d000000000000000000000000a0aaa080888080000000000000000000000bbbbbbb
0000000000000000000f0fbf0f00b000000000000000000e0eee0e0d0ddd0d000000000000000000000000a0aaa080888080000000000000000000000b0bbb0b
00000000000000000000ffbbbbbbb0000009000009000000eeeee000ddddd00000000000000000000000000aaaaa08888800000000000000000000000b0bbb0b
0000000000000000000000b0bbb0b0000009999999000000000000000000000000000d00000d000000000000000000000000000a00000a000000000000bbbbb0
0000000000000000000000b0bbb0b0000009099909000000000000000000000000000ddddddd000000000000000000000000000aaaaaaa0d00000d0000000000
00000000000000000000000bbbbb00000009099909000000000000000000000000000d0ddd0d000000b00000b00000000000000a0aaa0a0ddddddd0000000000
000000000000000000000000000000000000999990000000000000000000000000000d0ddd0d000000bbbbbbb00000000000000a0aaa0a0d0ddd0d0000000000
0000000000000000000000000000000000000000000000000000000000000000000000ddddd0000000b0bbb0b000000000000000aaaaa00d0ddd0d0000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000b0bbb0b0000000000000000000000addddda0000000000
0000000000000000000000000000000000000000800000800000000000000000000000000000000000ebbbbbe0000000000000000000000aaaaaaa0000000000
0000000000000000000000000000000000000000888888800000000000000000000000000000000000eeeeeee0000000000000000000000a0aaa0a0000000000
00000000000000000000000000a00000a0000000808880800000000000000000000000000000000000e0eee0e0000000000000000000000a0aaa0a0000000000
00000000000000000000000000aaaaaaa0000000808880800000000000000000000000000000000000e0eee0e00000000000000000000000aaaaa00000000000
00000008000008000000000000a0aaa0a00000000888880000000000000000000000000000000000000eeeee0000000000000000000000000000000000000000
00000008888888000000000000a0aaa0a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000088888088000000000000aaaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000008888888800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000088888080000000000000000000000000000000000000000000000000000000000000000c00000c00000000000000000000a00000a000000000000000
0000000080888080000000000000000000000000000000000000000000000000000000000000000ccccccc00000000000000000000aaaaaaa000000000000000
0000000008888800000000000000000000000000000000000000000000000000000000000000000c0ccc0c00900000900000000000a0aaa0a000000000000000
00000000000000000000000000000000000000000000000000d00000dd00000d000000000000000c0ccc0c009999a990f0a0000000a0aaa0a000000000000000
00000000000000000000000000000000000000000000000000dddddddddddddd0000000000000000ccccc0009099aaaaaaa0d00000daaaaa0000000000000000
00000000000000000000000000000000000000000000000000d0ddd0dd0ddd0d0000000000000000000000009099afaaa0a0ddddddd000000000000000000000
00000000000000000000000000000000000000000000000000d0ddd0dd0ddd0d0000000000000000000000000999a9aaa0a0d0ddd0d000000000000000000000
000000000000000000000000000000000000000000000000000ddddd00ddddd0000000000000000000000000000ffaaaaa00d0ddd0d000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ddddd0000000000000000000000
00000000000000000000000000000000000000000000000b00000b0000000000000000000000000000000000000000000000000000b00000b000000000000000
00000000000000000000000000000000000000000000000bbbbbbb0000000000000000000000000000000000000000000000000000bbbbbbb000d00000d00000
00000000000000000000000000000000000000000000000b0bbb0b0000c00000c00000000000000000000000000000000000000000b0bbb0b000ddddddd00000
00000000000000000000000000008000008000000000000b0bbb0b0000ccccccc00000000000e00000e00000000000000000009000b09bb0b000d0ddd0d00000
000000000000000000000000b00088888880000000000000bbbbb00000c0ccc0c00000000000eeeeeee00000000000000000009999999bbb0000d0ddd0d00000
000000000000000000000000bbbb8b8880800000000000000000000000c0ccc0c00000000d00e0ede0e0000000000000000000909990900000000ddddd000000
000000000000000000000000b0bb808880800e00000e000000000000000ccccc000000000ddddddde0e000000000000000000090999090000000000000000000
000000000000000000000000b0bbb88888000eeeeeee00d00000d00000000000000000000d0dddedee0000000000000000000009999900000000000000000000
0000000000000000000000000bbbbb0000000e0eee0e00ddddddd00000000000000000000d0ddd0d000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000e0eee0e00d0ddd0d000800000800000000000ddddd0000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000eeeee000d0ddd0d000888888800000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000ddddd00008088808000000000000000000000000000000000d00000d0000000000000000000000000
000000000000000000000000000000000000000000000000000000008088808000000000000000000000000000000000ddddddd0000000000009000009000000
000000000000000000000000000000000000000000000000000000000888880000000000000000000000000000000000d0ddd0d0000000000009999999090000
000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000d0ddd0d0080000080009099999990000
000000000000000000000000000000000000000000000000a00000a000000000000000000000000000000000000000000ddddd0008888888000909999e09000e
000000000000000000000000000000000000000000000000aaaaaaa00000000000000000f00000f000000000000000000000000008088808000099999eeeeeee
000000000000000000000000000000900000900000000000a0aaa0a00000000000000000fffffff000000000000000000000000008088808000000999e9eee0e
000000000000000000000000000000999999900000000000a0aaa0a00000000000000000f0fff0f0000000000000000000000000008888800c00000c0e0eee0e
0000000000000000000000000000009099909000000000000aaaaa000000a00000a00000f0fff0f0000000000000e00000e00000000000000ccccccc00eeeee0
000000000000000000000000000000909990990000090000000000000000aaaaaaa000000fffff00000000000000eeeeeee00000000000000c0ccc0c00000000
000000000000000000000000000000099999099999990000000000000000a0aaa0a00e00000e0000000000000000e0eee0e00000000000000c0ccc0c00000000
0000000000000000000000000000000000000909990900000000000b0000abaaa0a00eeeeeee0000000000000000e0eee0e000000000000000ccccc000000000
0000000000000000000000000000000000000909990900000000000bbbbbbbaaaa000e0eee0e00000000000000000eeeee000000000000000000000000000000
00000000000000000000000000000000000000999990000000000a0b0bbb0b0000000e0eee0e0000000000000000000000000000000000000000000000000000
0900000900000a00000a000000000000000000800000800000000aababbb0b00000000eeeee00000000000000000000000000000000000000000000000000000
0999999900000aaaaaaa000000000000000000888888800000000a0abbbbb0000000000000000000000000000000000000000000000000000000000000000000
0909990900000a0aaa0a00000a00000a000000808880800000000a0aaa0a0000000000000e00000e000000000000000000008000008000000000000000000000
0909990900000a0aaa0a00000aaaaaaa0000008088808000b00000baaaa00000000000000eeeeeee000000000000000000008888888000f00000f00000000000
00999990000000aaaaa000000a0aaa0a0000000888880000bbbbbbb000000000000000000e0eee0e0000000000000000c00080c8808000fffffff00000000000
0000000000000000000000000a0aaa0a0000000000000000b0bbb0b000000000000000000e0eee0e0000000000000000ccccccc8808000f0fff0f00000000000
00000000000000000000000000aafaa000f0000000000000b0bbb0b0000000000000000000eeeee00000000000000000c0ccc8c8880000f0fff0f00000000000
0000000000000000000000000000fffffff00000000000000bbbbb000000000000000000000000000000000000000000c0ccc0c00000a00fffff000000000000
0000000000000000000000080000f8fff0f000000080000080000000000000000000000000000000b00000b0000000000cccccaaaaaaa0000000000000000000
000000000000000000000008888888fff0f0000000888888800000000000e00000e0000000000000bbbbbbb0000000000b0000abaaa0a0000000000000000000
000000000000000000000008088808ffff00000000808880800000000000eeeeeee0000000000000b0bbb0b0000000000bbbbbabaaa0a0000000000000000000
000000000000000000000008088808000000000000808880800000000000e0eee0e0000000000000b0bbb0b0000000000b0bbb0aaaaa00000000000000000000
000000000000000000000000888880000000000000088888000000000000e0eee0e00000000000000bbbbb00000000000b0bbb0b000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000eeeee00000000000000000000000000000000bbbbb0000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000090000090000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000a00000a0000000000000099999990000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000aaaaaaa0000000000000090999090000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000a0aaa0a0000000000000090999090000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000a0000aaaaa0a0000000000000009999900000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000aacaaaaaaaa00000000000000000000000000000000000000000000000000000
0000000000000d00000d00000000000000000000000000000000000000000000a0ccccccc0000000000000000000000000000000000000000000000000000000
0000000000000ddddddd00000000000000000000000000000000000000000000a0caccc0c00a00000a0000000000000000000000000000000000000000000000
0000000000000deddded000000000000000f00000f00000000000000000000000acaccc0c00aaaaaaa0000000000000000000000000000000000000000000000
0000000000000d0ddd0d000000000000000fffffff0000000000000000000000000ccccc000a0aaa0a0000000000000000000000000000000000000000000000
0000000000000edddddee00000000000000f0fff0f000000000000000000000000000000000a0aaa0a0000000000000000000000000000000000000000000000
00000000000000eeeeeee00000000000000f0fff0f0000000000000000000000000000000000aaaaa00000000000000000000000000000000000000000000000
00000000000000e0eee0e000000000000000fffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000e0eee0e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000eeeee000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000008000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008888888000000000000000000000000
0000000c00000c000000000000000000000000000000000000000000000000000000000000000000000000000000000008088808000000000000000000000000
0000000ccccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000008088808000000000000000000000000
0000000c0ccc0c000000000000000000000000000000000000000000000000000000000000000000000000000000000000888880000000000000000000000000
0000000c0ccc0c000000000000000000000000000000000008000008000000000000000000000000000000000000000000000000000000000000000000000000
00000000ccccc00000000000000000000000000000000000088888880000000000000000000000000000000000000000000000000000000000a00000a0000000
000000000000000000000000000000000000000000000d00080d88080000000000000000000000000000000000000000000000000000000000aaaaaaa0000000
00000000000900000900000000000000000000000b000ddddddd88080000000000000000000000000000000000000000000000000000000000a0aaa0a0000000
00000000000999999900b00000d00000090000090bbbbdbddd8d88800000000000000000000000000000000000000000000000000000000000a0aaa0a0000000
0000000000090999b9bbbdddddd00000099999990b0bbd0ddd0d000000000000000000000000000000000000000000000000000000000000000aaaaa00000000
0000000000090999b9b0baddd0da0000090999090babbbddddd00000000000000000000000000000000000000000000000000000000000080000080000000000
00000000000099999bb0baaaaaaa0000090999a9aabbbbb000000000000000000000000000000000000000000000000000000000000000088888880000000000
000000000000000bbbbb0adaaa0a00000099999aa0a0000000000000000000000000000000000000000000000000000000000000000000080888080000000000
000000000000000000000a0aaa0a00000000a0aaa0a000000000000000000000000000000000000d00000d000000000000000000000000080888080000000000
0000000000000000000000aaaaa0000000000aaaaa0000000000000000000c00000c00000000000ddddddd0000000000f00000f0000000008888800000000000
0000000000000000b00000b00000000000000000000000000000000000000ccccccc00000000000d0ddd0d0000000000fffffff0000000000000000000000000
0000000000000000bbbbbbb0000000000000000000000000000000000a000c0ac80c00080000000d0ddd0d0000000000f0fff0f0000000000000000000000000
0000000000000000b0bbb0b000000000000000000f00000f000000000aaaaaaac888888800000000ddddd00000000000f0fff0f0000000000000000000000000
0000000000000000b0bbb0b000000000000000000fffffff000000000a0aaacac8c888080000000000000000000000000fffff00000000000000000000000000
00000000000000000bbbbb0000000000000000000f0fff0f000000000a0aaa0a0808880800000000000000000000000000000000000000a00000a00000000000
00000000000000000000000000000000000000000f0fff0f0000000000aaaaa00088888000000000000000000000000000000000000000aaaaaaa00000000000
000000000000000000000000000000000000000000fffff000000000000000000000000000000000000000000000000000000000000000a0aaa0a00000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a0aaa0a00000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000aaaaa000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000033333000000030030303330330033303030333000003330033030300000333033303030300000300000000000000000000000000000
00000000000000000000333003300000303030303030303003003030333000003030303030300000003030003030333333300000000000000000000000000000
00000000000000000000330003300000303030303330303003003030303000003300303003000000333033303330303330300000000000000000000000000000
00000000000000000000333003300000330030303030303003003030303000003030303030300000300000300030303330300000000000000000000000000000
00000000000000000000033333000000033003303030303003000330303000003330330030300000333033300030033333000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

__sfx__
00030000286502b6702b640286201f610276002760027600276001860016600196000060000600006003160000600006000060000600006000060000600006000060000600006000060000600006000060000600
